{"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Maria\\\\Aptugo\\\\build\\\\ESCRIBANIA\\\\back-end\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Maria\\\\Aptugo\\\\build\\\\ESCRIBANIA\",\"filename\":\"C:\\\\Users\\\\Maria\\\\Aptugo\\\\build\\\\ESCRIBANIA\\\\back-end\\\\index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Maria\\\\Aptugo\\\\build\\\\ESCRIBANIA\",\"plugins\":[],\"presets\":[]}:7.13.10:development":{"value":{"code":"const dotenv = require('dotenv');\ndotenv.config({\n  path: './config/.env.development'\n});\nconst fs = require('fs');\nconst express = require('express');\nconst bodyParser = require('body-parser');\nconst fileupload = require('express-fileupload');\nconst app = express();\napp.set('filesFolder', __dirname + '/../dist/img');\napp.use(function (req, res, next) {\n  res.header('Access-Control-Allow-Origin', '*');\n  res.header('Access-Control-Allow-Headers', 'Origin, X-Requested-With, Content-Type, Accept, XMLHttpRequest, authorization, *');\n  res.header('Access-Control-Allow-Methods', '*');\n  next();\n});\napp.use(bodyParser.urlencoded({\n  extended: false\n}));\napp.use(bodyParser.json({\n  limit: '10mb'\n}));\napp.use(fileupload());\napp.all('*', checkReq);\nfunction checkReq(req, res, next) {\n  if (req.files) {\n    const keys = Object.keys(req.files);\n    keys.forEach(key => {\n      const regex = /(.*)\\[([0-9]*)\\]/gm;\n      let m = regex.exec(key);\n      if (m) {\n        if (m[2] === '0') {\n          req.body[m[1]] = [];\n          req.files[m[1]] = [];\n        }\n        req.body[m[1]].push(req.files[key]);\n        req.files[m[1]].push(req.files[key]);\n        delete req.files[key];\n      }\n    });\n  }\n  next();\n}\nconst dbConfig = require('./config/database.config.js');\nconst mongoose = require('mongoose');\nmongoose.Promise = global.Promise;\n\n// Connecting to the database\nmongoose.set('strictQuery', false);\nmongoose.connect(dbConfig.url, {\n  useNewUrlParser: true,\n  useUnifiedTopology: true\n}).then(() => {\n  console.log('Successfully connected to the database');\n}).catch(err => {\n  console.log('Could not connect to the database. Exiting now...', err);\n  // process.exit();\n});\nrequire('./app/routes/apiRoutes.js')(app);\napp.use('/images', express.static(__dirname + '/../dist/img'));\nlet tries = 0;\nfunction doListen() {\n  const port = 4567;\n  const server = app.listen(port, '0.0.0.0').on('listening', () => {\n    console.log(`Aptugo app listening on port ${port}!`);\n  }).on('error', err => {\n    if (err.errno === 'EADDRINUSE') {\n      if (tries < 3) {\n        console.log('Port busy, waiting a couple of seconds...');\n        tries++;\n        setTimeout(doListen, 2000);\n      } else {\n        console.log('Tired of waiting, will kill the process...');\n        exec(`kill -9 $(lsof -t -i:${port})`);\n        setTimeout(doListen, 2000);\n      }\n    } else {\n      console.log(err);\n    }\n  }).on('connection', conn => {\n    console.log('connection');\n  });\n}\ndoListen();\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJkb3RlbnYiLCJyZXF1aXJlIiwiY29uZmlnIiwicGF0aCIsImZzIiwiZXhwcmVzcyIsImJvZHlQYXJzZXIiLCJmaWxldXBsb2FkIiwiYXBwIiwic2V0IiwiX19kaXJuYW1lIiwidXNlIiwicmVxIiwicmVzIiwibmV4dCIsImhlYWRlciIsInVybGVuY29kZWQiLCJleHRlbmRlZCIsImpzb24iLCJsaW1pdCIsImFsbCIsImNoZWNrUmVxIiwiZmlsZXMiLCJrZXlzIiwiT2JqZWN0IiwiZm9yRWFjaCIsImtleSIsInJlZ2V4IiwibSIsImV4ZWMiLCJib2R5IiwicHVzaCIsImRiQ29uZmlnIiwibW9uZ29vc2UiLCJQcm9taXNlIiwiZ2xvYmFsIiwiY29ubmVjdCIsInVybCIsInVzZU5ld1VybFBhcnNlciIsInVzZVVuaWZpZWRUb3BvbG9neSIsInRoZW4iLCJjb25zb2xlIiwibG9nIiwiY2F0Y2giLCJlcnIiLCJzdGF0aWMiLCJ0cmllcyIsImRvTGlzdGVuIiwicG9ydCIsInNlcnZlciIsImxpc3RlbiIsIm9uIiwiZXJybm8iLCJzZXRUaW1lb3V0IiwiY29ubiJdLCJzb3VyY2VSb290IjoiQzpcXFVzZXJzXFxNYXJpYVxcQXB0dWdvXFxidWlsZFxcRVNDUklCQU5JQVxcYmFjay1lbmRcXCIsInNvdXJjZXMiOlsiaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZG90ZW52ID0gcmVxdWlyZSgnZG90ZW52JylcbmRvdGVudi5jb25maWcoeyBwYXRoOiAnLi9jb25maWcvLmVudi5kZXZlbG9wbWVudCcgfSlcbmNvbnN0IGZzID0gcmVxdWlyZSgnZnMnKVxuY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKVxuY29uc3QgYm9keVBhcnNlciA9IHJlcXVpcmUoJ2JvZHktcGFyc2VyJylcbmNvbnN0IGZpbGV1cGxvYWQgPSByZXF1aXJlKCdleHByZXNzLWZpbGV1cGxvYWQnKVxuXG5jb25zdCBhcHAgPSBleHByZXNzKClcbmFwcC5zZXQoJ2ZpbGVzRm9sZGVyJywgX19kaXJuYW1lICsgJy8uLi9kaXN0L2ltZycpXG5hcHAudXNlKGZ1bmN0aW9uIChyZXEsIHJlcywgbmV4dCkge1xuICByZXMuaGVhZGVyKCdBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW4nLCAnKicpXG4gIHJlcy5oZWFkZXIoJ0FjY2Vzcy1Db250cm9sLUFsbG93LUhlYWRlcnMnLCAnT3JpZ2luLCBYLVJlcXVlc3RlZC1XaXRoLCBDb250ZW50LVR5cGUsIEFjY2VwdCwgWE1MSHR0cFJlcXVlc3QsIGF1dGhvcml6YXRpb24sIConKVxuICByZXMuaGVhZGVyKCdBY2Nlc3MtQ29udHJvbC1BbGxvdy1NZXRob2RzJywgJyonKVxuICBuZXh0KClcbn0pXG5cbmFwcC51c2UoYm9keVBhcnNlci51cmxlbmNvZGVkKHsgZXh0ZW5kZWQ6IGZhbHNlIH0pKVxuYXBwLnVzZShib2R5UGFyc2VyLmpzb24oeyBsaW1pdDogJzEwbWInIH0pKVxuYXBwLnVzZShmaWxldXBsb2FkKCkpXG5hcHAuYWxsKCcqJywgY2hlY2tSZXEpXG5mdW5jdGlvbiBjaGVja1JlcShyZXEsIHJlcywgbmV4dCkge1xuICBpZiAocmVxLmZpbGVzKSB7XG4gICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHJlcS5maWxlcylcbiAgICBrZXlzLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgY29uc3QgcmVnZXggPSAvKC4qKVxcWyhbMC05XSopXFxdL2dtXG4gICAgICBsZXQgbSA9IHJlZ2V4LmV4ZWMoa2V5KVxuICAgICAgaWYgKG0pIHtcbiAgICAgICAgaWYgKG1bMl0gPT09ICcwJykge1xuICAgICAgICAgIHJlcS5ib2R5W21bMV1dID0gW11cbiAgICAgICAgICByZXEuZmlsZXNbbVsxXV0gPSBbXVxuICAgICAgICB9XG4gICAgICAgIHJlcS5ib2R5W21bMV1dLnB1c2gocmVxLmZpbGVzW2tleV0pXG4gICAgICAgIHJlcS5maWxlc1ttWzFdXS5wdXNoKHJlcS5maWxlc1trZXldKVxuICAgICAgICBkZWxldGUgcmVxLmZpbGVzW2tleV1cbiAgICAgIH1cbiAgICB9KVxuICB9XG4gIG5leHQoKVxufVxuXG5jb25zdCBkYkNvbmZpZyA9IHJlcXVpcmUoJy4vY29uZmlnL2RhdGFiYXNlLmNvbmZpZy5qcycpXG5jb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJ21vbmdvb3NlJylcblxubW9uZ29vc2UuUHJvbWlzZSA9IGdsb2JhbC5Qcm9taXNlXG5cbi8vIENvbm5lY3RpbmcgdG8gdGhlIGRhdGFiYXNlXG5tb25nb29zZS5zZXQoJ3N0cmljdFF1ZXJ5JywgZmFsc2UpXG5tb25nb29zZVxuICAuY29ubmVjdChkYkNvbmZpZy51cmwsIHtcbiAgICB1c2VOZXdVcmxQYXJzZXI6IHRydWUsXG4gICAgdXNlVW5pZmllZFRvcG9sb2d5OiB0cnVlLFxuICB9KVxuICAudGhlbigoKSA9PiB7XG4gICAgY29uc29sZS5sb2coJ1N1Y2Nlc3NmdWxseSBjb25uZWN0ZWQgdG8gdGhlIGRhdGFiYXNlJylcbiAgfSlcbiAgLmNhdGNoKChlcnIpID0+IHtcbiAgICBjb25zb2xlLmxvZygnQ291bGQgbm90IGNvbm5lY3QgdG8gdGhlIGRhdGFiYXNlLiBFeGl0aW5nIG5vdy4uLicsIGVycilcbiAgICAvLyBwcm9jZXNzLmV4aXQoKTtcbiAgfSlcblxucmVxdWlyZSgnLi9hcHAvcm91dGVzL2FwaVJvdXRlcy5qcycpKGFwcClcblxuYXBwLnVzZSgnL2ltYWdlcycsIGV4cHJlc3Muc3RhdGljKF9fZGlybmFtZSArICcvLi4vZGlzdC9pbWcnKSlcblxubGV0IHRyaWVzID0gMFxuXG5mdW5jdGlvbiBkb0xpc3RlbigpIHtcbiAgY29uc3QgcG9ydCA9IDQ1NjdcbiAgY29uc3Qgc2VydmVyID0gYXBwXG4gICAgLmxpc3Rlbihwb3J0LCAnMC4wLjAuMCcpXG4gICAgLm9uKCdsaXN0ZW5pbmcnLCAoKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhgQXB0dWdvIGFwcCBsaXN0ZW5pbmcgb24gcG9ydCAke3BvcnR9IWApXG4gICAgfSlcbiAgICAub24oJ2Vycm9yJywgKGVycikgPT4ge1xuICAgICAgaWYgKGVyci5lcnJubyA9PT0gJ0VBRERSSU5VU0UnKSB7XG4gICAgICAgIGlmICh0cmllcyA8IDMpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnUG9ydCBidXN5LCB3YWl0aW5nIGEgY291cGxlIG9mIHNlY29uZHMuLi4nKVxuICAgICAgICAgIHRyaWVzKytcbiAgICAgICAgICBzZXRUaW1lb3V0KGRvTGlzdGVuLCAyMDAwKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdUaXJlZCBvZiB3YWl0aW5nLCB3aWxsIGtpbGwgdGhlIHByb2Nlc3MuLi4nKVxuICAgICAgICAgIGV4ZWMoYGtpbGwgLTkgJChsc29mIC10IC1pOiR7cG9ydH0pYClcbiAgICAgICAgICBzZXRUaW1lb3V0KGRvTGlzdGVuLCAyMDAwKVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpXG4gICAgICB9XG4gICAgfSlcbiAgICAub24oJ2Nvbm5lY3Rpb24nLCAoY29ubikgPT4ge1xuICAgICAgY29uc29sZS5sb2coJ2Nvbm5lY3Rpb24nKVxuICAgIH0pXG59XG5cbmRvTGlzdGVuKClcbiJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsTUFBTSxHQUFHQyxPQUFPLENBQUMsUUFBUSxDQUFDO0FBQ2hDRCxNQUFNLENBQUNFLE1BQU0sQ0FBQztFQUFFQyxJQUFJLEVBQUU7QUFBNEIsQ0FBQyxDQUFDO0FBQ3BELE1BQU1DLEVBQUUsR0FBR0gsT0FBTyxDQUFDLElBQUksQ0FBQztBQUN4QixNQUFNSSxPQUFPLEdBQUdKLE9BQU8sQ0FBQyxTQUFTLENBQUM7QUFDbEMsTUFBTUssVUFBVSxHQUFHTCxPQUFPLENBQUMsYUFBYSxDQUFDO0FBQ3pDLE1BQU1NLFVBQVUsR0FBR04sT0FBTyxDQUFDLG9CQUFvQixDQUFDO0FBRWhELE1BQU1PLEdBQUcsR0FBR0gsT0FBTyxDQUFDLENBQUM7QUFDckJHLEdBQUcsQ0FBQ0MsR0FBRyxDQUFDLGFB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","map":{"version":3,"names":["dotenv","require","config","path","fs","express","bodyParser","fileupload","app","set","__dirname","use","req","res","next","header","urlencoded","extended","json","limit","all","checkReq","files","keys","Object","forEach","key","regex","m","exec","body","push","dbConfig","mongoose","Promise","global","connect","url","useNewUrlParser","useUnifiedTopology","then","console","log","catch","err","static","tries","doListen","port","server","listen","on","errno","setTimeout","conn"],"sourceRoot":"C:\\Users\\Maria\\Aptugo\\build\\ESCRIBANIA\\back-end\\","sources":["index.js"],"sourcesContent":["const dotenv = require('dotenv')\ndotenv.config({ path: './config/.env.development' })\nconst fs = require('fs')\nconst express = require('express')\nconst bodyParser = require('body-parser')\nconst fileupload = require('express-fileupload')\n\nconst app = express()\napp.set('filesFolder', __dirname + '/../dist/img')\napp.use(function (req, res, next) {\n  res.header('Access-Control-Allow-Origin', '*')\n  res.header('Access-Control-Allow-Headers', 'Origin, X-Requested-With, Content-Type, Accept, XMLHttpRequest, authorization, *')\n  res.header('Access-Control-Allow-Methods', '*')\n  next()\n})\n\napp.use(bodyParser.urlencoded({ extended: false }))\napp.use(bodyParser.json({ limit: '10mb' }))\napp.use(fileupload())\napp.all('*', checkReq)\nfunction checkReq(req, res, next) {\n  if (req.files) {\n    const keys = Object.keys(req.files)\n    keys.forEach((key) => {\n      const regex = /(.*)\\[([0-9]*)\\]/gm\n      let m = regex.exec(key)\n      if (m) {\n        if (m[2] === '0') {\n          req.body[m[1]] = []\n          req.files[m[1]] = []\n        }\n        req.body[m[1]].push(req.files[key])\n        req.files[m[1]].push(req.files[key])\n        delete req.files[key]\n      }\n    })\n  }\n  next()\n}\n\nconst dbConfig = require('./config/database.config.js')\nconst mongoose = require('mongoose')\n\nmongoose.Promise = global.Promise\n\n// Connecting to the database\nmongoose.set('strictQuery', false)\nmongoose\n  .connect(dbConfig.url, {\n    useNewUrlParser: true,\n    useUnifiedTopology: true,\n  })\n  .then(() => {\n    console.log('Successfully connected to the database')\n  })\n  .catch((err) => {\n    console.log('Could not connect to the database. Exiting now...', err)\n    // process.exit();\n  })\n\nrequire('./app/routes/apiRoutes.js')(app)\n\napp.use('/images', express.static(__dirname + '/../dist/img'))\n\nlet tries = 0\n\nfunction doListen() {\n  const port = 4567\n  const server = app\n    .listen(port, '0.0.0.0')\n    .on('listening', () => {\n      console.log(`Aptugo app listening on port ${port}!`)\n    })\n    .on('error', (err) => {\n      if (err.errno === 'EADDRINUSE') {\n        if (tries < 3) {\n          console.log('Port busy, waiting a couple of seconds...')\n          tries++\n          setTimeout(doListen, 2000)\n        } else {\n          console.log('Tired of waiting, will kill the process...')\n          exec(`kill -9 $(lsof -t -i:${port})`)\n          setTimeout(doListen, 2000)\n        }\n      } else {\n        console.log(err)\n      }\n    })\n    .on('connection', (conn) => {\n      console.log('connection')\n    })\n}\n\ndoListen()\n"],"mappings":"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","ignoreList":[]}},"mtime":1736807486141}}